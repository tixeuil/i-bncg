Code and results for the undirected case
